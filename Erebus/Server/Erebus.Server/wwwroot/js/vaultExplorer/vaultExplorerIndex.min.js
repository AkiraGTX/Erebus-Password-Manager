var vaultExplorerIndex=function(e){var d="vault-tree",t="add-group-button",o="add-sub-group-button",n="edit-group-button",r="add-entry-button";return e.init=function(){$("#"+d).jstree({core:{data:{url:function(e){return"/VaultExplorer/GetNodeItems"},data:function(e){return{parentId:e.id}}}}}),$("#"+t).on("click",e.addGroup),$("#"+o).on("click",e.addSubGroup),$("#"+n).on("click",e.editGroup),$("#"+r).on("click",e.addEntry),$("#"+d).on("changed.jstree",e.onTreeNodeChange)},e.onTreeNodeChange=function(e,d){d.node&&d.node.li_attr&&"group"===d.node.li_attr["node-type"]?($("#"+o).prop("disabled",!1),$("#"+n).prop("disabled",!1),$("#"+r).prop("disabled",!1)):($("#"+o).prop("disabled",!0),$("#"+n).prop("disabled",!0),$("#"+r).prop("disabled",!0))},e.addGroup=function(){$.ajax({url:"/VaultExplorer/AddOrEditGroup",method:"GET",data:{parentId:"#"}}).done(function(e){$("body").append(e)})},e.addSubGroup=function(){var e=$("#"+d).jstree().get_selected(!0);if(1===e.length){var t=e[0];$.ajax({url:"/VaultExplorer/AddOrEditGroup",method:"GET",data:{parentId:t.id}}).done(function(e){$("body").append(e)})}},e.editGroup=function(){var e=$("#"+d).jstree().get_selected(!0);if(1===e.length){var t=e[0];$.ajax({url:"/VaultExplorer/AddOrEditGroup",method:"GET",data:{id:t.id,parentId:t.parent}}).done(function(e){$("body").append(e)})}},e.addEntry=function(){},e.refreshNode=function(e){var t=$("#"+d).jstree(),o=t.get_node(e);t.load_node(o),t.open_node(o)},e.submitModalForm=function(d,t,o){$("#"+d).submit(function(d){if($(this).valid()){var n=$(this).serializeArray(),r=$(this).attr("action");$.ajax({url:r,type:"POST",data:n,success:function(d,n,r){d.success&&(e.closeModal(t),e.refreshNode(o))}})}d.preventDefault()}),$("#"+d).submit()},e.closeModal=function(e){$("#"+e).on("hidden.bs.modal",function(){$("#"+e).remove()}),$("#"+e).modal("hide")},e}(vaultExplorerIndex||{});$(function(){vaultExplorerIndex.init()});